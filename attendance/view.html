---
title: FIRST¬Æ Alumni &amp; Mentors Network at Michigan
---
<!DOCTYPE html>
<html lang='en'>
<head>
    {% include title-styles.html %}
</head>
<body>
    {% include header.html %}
    
    <div class="w-75 pt-5 mx-auto d-flex justify-content-evenly">
        <h1 class="col-10">FAMNM Attendance</h1>
        <p class='col-10'>
            <a href="index.html" class="btn famnm-btn-secondary">+</a>
        </p>
    </div>
    
    <div class="mt-5 w-75 mx-auto">
        <div class="d-flex justify-content-between">
            <h2 class='col-10'>Members</h2>
            <button type="button" class="col-2 btn famnm-btn-secondary mb-3" id="toggle-active"><!-- Filled by JavaScript --></button>
        </div>

        <table class="table" id="members">
            <thead>
                <tr>
                    <th scope="col">Uniqname</th>
                    <th scope="col">Active</th>
                    <th scope="col">Attendances This Semester</th>
                    <th scope="col">Attendances Last Semester</th>
                    <th scope="col">Mentor</th>
                </tr>
            </thead>
            <tbody id="members-body">
                <!-- Filled by JavaScript -->
            </tbody>
        </table>
    </div>
    
    <div class="mt-5 w-75 mx-auto">
        <div class="d-flex justify-content-between">
            <h2 class='col-6'>Meetings</h2>
            <div class='col-6 mx-auto uniqname-search d-flex justify-content-end mb-3'>
                <input id='uniqname' type='text' placeholder='uniqname'/>
                <button type="button" class="btn famnm-btn-secondary ml-1" data-toggle="modal" id="search">Search</button>
                <button type="button" class="btn btn-secondary ml-1" data-toggle="modal" id="clear">Clear</button>
            </div>
        </div>

        <table class="table all-meetings">
            <thead>
                <tr>
                    <th scope="col">Date</th>
                    <th scope="col">Type</th>
                    <th scope="col">Attendees</th>
                </tr>
            </thead>
            <tbody id="meeting-body">
                <!-- Filled by JavaScript -->
            </tbody>
        </table>
    </div>
    
    {% include footer.html %}
    {% include scripts.html %}
    <script>
        let onlyActiveMembers = false
        
        const backend_url = 'https://famnm-website-backend.herokuapp.com/api/v2'

        const dateToString = (date) => {
            const monthIdxToString = {
                0: "Jan", 1: "Feb", 2: "Mar", 3: "Apr",
                4: "May", 5: "June", 6: "July", 7: "Aug",
                8: "Sep", 9: "Oct", 10: "Nov", 11: "Dec"
            }

            return `${monthIdxToString[date.getUTCMonth()]} ${date.getUTCDate()}, ${date.getUTCFullYear()}`
        }

        const populateMemberTable = (members) => {
            members.sort((a, b) => {
                if (a.active && !b.active) {
                    return -1;
                } else if (!a.active && b.active) {
                    return 1;
                } else if (a.this_semester !== b.this_semester) {
                    return b.this_semester - a.this_semester;
                } else if (a.last_semester !== b.last_semester) {
                    return b.last_semester - a.last_semester;
                } else if (a.mentor && !b.mentor) {
                    return -1;
                } else if (!a.mentor && b.mentor) {
                    return 1;
                } else {
                    return a.uniqname.localeCompare(b.uniqname);
                }
            });

            $('#members-body').empty();

            members.forEach(member => {
                const newRow = $(`
                    <tr id="meeting-${member.uniqname}">
                        <th>${member.uniqname}</th>
                        <td>${member.active ? '‚úÖ' : 'üö´'}</td>
                        <td>${member.this_semester}</td>
                        <td>${member.last_semester}</td>
                        <td>${member.mentor !== null ? (member.mentor ? '‚úÖ' : 'üö´') : '‚ùì'}</td>
                    </tr>
                `);

                $('#members-body').append(newRow);
            });
        }

        const populateMeetingTable = (meetings) => {
            meetings.sort((a, b) => new Date(b.meeting_date) - new Date(a.meeting_date));

            $('#meeting-body').empty();

            meetings.forEach(meeting => {
                const meetingDate = new Date(meeting.meeting_date);

                let attendeeString = "";
                meeting.attendees.forEach(attendee => {
                    attendeeString += `${attendee}, `;
                });
                attendeeString = attendeeString.slice(0, -2);

                const newRow = $(`
                    <tr id="meeting-${meeting.id}">
                        <th>${dateToString(meetingDate)}</th>
                        <td>${meeting.meeting_type}</td>
                        <td>${attendeeString}</td>
                    </tr>
                `);

                $('#meeting-body').append(newRow);
            });
        }

        const getMembers = () => {
            if (onlyActiveMembers) {
                $('#toggle-active').text('Show Non-Active');
            } else {
                $('#toggle-active').text('Hide Non-Active');
            }

            const url = backend_url + (onlyActiveMembers ? '/member/active' : '/member');

            fetch(url)
            .then(response => {
                if (!response.ok) throw Error(response.statusText);
                return response.json();
            })
            .then(populateMemberTable)
            .catch(console.log);
        }

        const getAllMeetings = () => {
            fetch(backend_url + "/meeting")
            .then(response => {
                if (!response.ok) throw Error(response.statusText);
                return response.json();
            })
            .then(populateMeetingTable)
            .catch(console.log);
        }

        const getMeetingsByUniqname = () => {
            const query = $('#uniqname').val().toLowerCase();

            if (query === "") {
                getAllMeetings();
            } else {
                fetch(`${backend_url}/meeting/uniqname/${query}`)
                .then(response => {
                    if (!response.ok) throw Error(response.statusText);
                    return response.json();
                })
                .then(populateMeetingTable)
                .catch(console.log);
            }
        }
        
        $(() => {
            getMembers();
            getAllMeetings();

            $('#toggle-active').click(() => {
                onlyActiveMembers = !onlyActiveMembers;
                getMembers();
            });
            
            $('#uniqname').keypress(e => {
                if (e.keyCode == 13) {
                    e.preventDefault();
                    getMeetingsByUniqname();
                }
            });
            
            $('#search').click(getMeetingsByUniqname);
            
            $('#clear').click(e => {
                e.preventDefault();
                $('#uniqname').val('');
                getAllMeetings();
            });
        });
    </script>
</body>
</html>
